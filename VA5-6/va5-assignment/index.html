<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>HTML + CSS</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" />
  </head>
  <body class="container">
    <h1 class="my-3 mt-5">Movie Database</h1>
    <h2>GET Movies</h2>
    <button id="getBtn" class="btn btn-primary my-2">Get Movies</button>
    <div id="getContainer" class="my-3">
     
      
    </div>
    <h2>POST  Movie</h2>
  

<form action="" id="form">
    <div class="mb-3 mt-3">
      <label for="title" >Title:</label>
      <input type="text" class="form-control" id="title" >
    </div>
    <div class="mb-3 mt-3">
      <label for="year" >Release Year:</label>
      <input type="number" class="form-control" id="year" >
    </div>
    <label for="Genre">Genre : </label>
  
    <select class="form-select"  id="Genre">
      
      <option value="Action">Action</option>
      <option value="Drama">Drama</option>
      <option value="Comedy">Comedy</option>
      <option value="Romance">Romance</option>
      <option value="Thriller">Thriller</option>
      <option value="Fantasy">Fantasy</option>
      <option value="Si-Fi">Si-Fi</option>
      <option value="Horror">Horror</option>
      <option value="Sports">Sports</option>
      <option value="Musical">Musical</option>
      <option value="Others">Others</option>
    </select>
    <div class="mb-3 mt-3">
      <label for="Director" >Director :</label>
      <input type="text" class="form-control" id="Director" >
    </div>
    <div class="mb-3 mt-3">
      <label for="Language" >Language :</label>
      <input type="text" class="form-control" id="Language" >
    </div>

    <label for="Country">Country : </label>
  
    <select class="form-select"  id="Country">
      
      <option value="India">India</option>
      <option value="USA">USA</option>
      <option value="UK">UK</option>
      <option value="China">China</option>
      <option value="Japan">Japan</option>
      
    </select>

      <div class="mb-3 mt-3">
        <label for="Rating" >Rating :</label>
        <input type="number" class="form-control" id="Rating" >
      </div>
      <div class="mb-3">
        <label for="plot" >Plot</label>
        <textarea class="form-control" id="plot" rows="3"></textarea>
      </div>

      <div class="mb-3 mt-3">
        <label for="Awards" >Awards :</label>
        <input type="text" class="form-control" id="Awards" >
      </div>
      <div class="mb-3 mt-3">
        <label for="Poster" >Poster URL :</label>
        <input type="text" class="form-control" id="Poster" >
      </div>
      <div class="mb-3 mt-3">
        <label for="trailer" >Trailer URL :</label>
        <input type="text" class="form-control" id="trailer" >
      </div>
   
    <button type="submit" class="btn btn-success">Submit</button>
  </form>
  <div id="PostRes" class="my-3">

  </div>
    <script>
 
    
 let form = document.getElementById('form');
      let getBtn = document.getElementById('getBtn');
      let getContainer = document.getElementById('getContainer');
      let PostRes = document.getElementById('PostRes');
 let ids = [];
      

      form.addEventListener('submit', function(event) {
        event.preventDefault();
    
        let obj = {
          title: document.getElementById('title').value,
          releaseYear: document.getElementById('year').value,
          genre: document.getElementById('Genre').value,
          director: document.getElementById('Director').value,
          language: document.getElementById('Language').value,
          country: document.getElementById('Country').value,
          rating: document.getElementById('Rating').value,
          plot: document.getElementById('plot').value,
          awards: document.getElementById('Awards').value,
          posterUrl: document.getElementById('Poster').value,
          trailerUrl: document.getElementById('trailer').value
        };
    
        let url = `https://va-5-assignment-express-student-neog.replit.app/movies`;
    
        fetch(url, {
          method: "POST",
          body: JSON.stringify(obj),
          headers: {
            'content-type': 'application/json'
          }
        })
        .then(function(res) {
          return res.json();
        })
        .then(function(data) {
         
          PostRes.textContent = JSON.stringify(data);
             console.log("HI" + JSON.stringify(data._id))
            // ids.push(data._id); //here undefined  
          
         
        });
      });



  


      getBtn.addEventListener('click', function(event) {
        let url = `https://va-5-assignment-express-student-neog.replit.app/movies`;
        fetch(url)
          .then(function(res) {
            return res.json();
          })
          .then(function(data) {
            console.log(data)
            getContainer.innerHTML = "";
           
              // for (let i = 0; i < ids.length; i++) {
              for (let j = 0; j < data.length; j++) {
                // if (ids[i] == data[j]._id) {
                  getContainer.innerHTML += `
                    <div class="card my-4" style="width: 105%;">
                      <div class="card-body">
                        <h5 class="card-title">Movie ID : ${data[j]._id}</h5>
                        <p class="card-text">${JSON.stringify(data[j])}</p>
                      </div>
                    </div>`;
                // }
              // }
          
       
          }});
      });
    
    </script>
    

  </body>
</html>
