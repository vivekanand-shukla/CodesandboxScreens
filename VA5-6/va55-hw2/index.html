<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>HTML + CSS</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" />
  </head>
  <body class="container">
    <h1 class="my-3 mt-5">Book Database</h1>
    <h2>GET request</h2>
    <button id="getBtn" class="btn btn-primary my-2">Get Data</button>
    <div id="getContainer" class="my-3">
     
      
    </div>
    <h2>POST Request</h2>
  

<form action="" id="form">
    <div class="mb-3 mt-3">
      <label for="Book" >Book Name :</label>
      <input type="text" class="form-control" id="Book" >
    </div>
    <div class="mb-3 mt-3">
      <label for="Author" >Author :</label>
      <input type="text" class="form-control" id="Author" >
    </div>
 
    <button type="submit" class="btn btn-success">Submit</button>
  </form>
  <div id="PostRes" class="my-3">

    
    <script>
      let form = document.getElementById('form')
      let Book = document.getElementById('Book')
      let Author = document.getElementById('Author')
      let PostRes = document.getElementById('PostRes')
      let getBtn = document.getElementById('getBtn')
      let getContainer = document.getElementById('getContainer')
  let ids = []

      getBtn.addEventListener('click',function(event){
        
      
           let url = `https://post-books-student-neog.replit.app/books`
           fetch(url).then(function(res){
              return res.json()
           }).then(function(data){
            getContainer.innerHTML =""
            for(let i= 0;i<ids.length;i++){
                for(let j=0;j<data.length;j++){
                  if(ids[i] === data[j]._id ){

                    getContainer.innerHTML +=` <div class="card my-4" style="width: 115%;">
       
       <div class="card-body">
         <h5 class="card-title">Book ID : ${data[j]._id}</h5>
         <p class="card-text">${JSON.stringify(data[j])}</p>
        
       </div>
     </div>`
                  }
                }
            }
             
           })
      })












      
      form.addEventListener('submit',function(event){
           event.preventDefault();
           let obj ={
            bookName:Book.value,
            author:Author.value
           }
           let url = `https://post-books-student-neog.replit.app/books`
           fetch(url,{
            method:"POST",
            body:JSON.stringify(obj),
            headers:{
              'content-type':'application/json'
            }
           }).then(function(res){
              return res.json()
           }).then(function(data){
            PostRes.textContent = JSON.stringify(data)
            ids.push(data._id)
            
           })
      })
      
    </script>
  </div>
  </body>
</html>
